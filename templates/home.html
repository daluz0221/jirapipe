{% load static date_filters %}

<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='UTF-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0'>
    <link rel='stylesheet' href="{% static 'css/styles.css' %}">
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css'
    integrity='sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==' crossorigin='anonymous'
    referrerpolicy='no-referrer' />
    <title></title>
</head>
<body>



    <header>
        <h1>Página de pipe</h1>
    </header>
    
    {% block content %}
        

        
    <h2>Inicio Jira {{ user.get_username }}</h2>

    
    {% if user_incidencias %}
        <h3>Tus incidencias</h3>
        {% for incidencia in user_incidencias %}
            Título: {{ incidencia.titulo }} <br>
            descripcion: {{ incidencia.descripcion }}<br>
            progreso: {{ incidencia.progreso|to_percentage }}<br>
            
            {% if incidencia.prioridad == 1 %}
                Prioridad: Alta <br>
            {% elif incidencia.prioridad == 2 %}
                Prioridad: Media <br>
            {% elif incidencia.prioridad == 3 %}
                Prioridad: Baja     <br>
            {% endif %}
            
            Tipo de incidencia: {{ incidencia.tipo }} <br>
            
            Fecha límite: {{ incidencia.Fecha_limite }}<br>

            <a href="{% url 'jobs_app:incidencia_detail' incidencia_slug=incidencia.slug %}">Ver incidencia</a>
            <br>
            <!-- Botón para abrir el modal 2-->
            <button type="button" class="edit_incidence" data-slug="{{ incidencia.slug }}">
                Editar incidencia
            </button>
            <br><br><br>

        {% endfor %}
    {% else %}
        <h3>De momento no tienes incidencias activas</h3>
    {% endif %}

    <!-- Botón para abrir el modal -->
    <button type="button" class="create_incidence">
        Crear nueva incidencia
    </button>

    

    <!-- Modal -->
    <section class="modal" id="editar_modal">
        <form  class="modal__container" method="post" action="{% url 'jobs_app:create_incidence' %}">
            <span class="modal__close">X</span>
            {% csrf_token %}
            <!-- <div class="modal__title">modal title</div>
            <div class="modal_paragraph">
                Lorem ipsum dolor sit, amet consectetur adipisicing elit. A asperiores, earum aperiam molestiae deserunt optio?
            </div> -->
            {{ incidence_form.as_p }}
            <button type="submit" class="modal__close">Cerrar modal</button>
        </form>
    </section>
    <!-- fin Modal -->

    <!-- Modal 2-->
    <section id="modal_edit" class="modal">
        <form id="edit__form" class="modal__container" method="post" >
            <span id="close_modal" class="modal__close">X</span>
            {% csrf_token %}
            <!-- <div class="modal__title">modal title</div>
            <div class="modal_paragraph">
                Lorem ipsum dolor sit, amet consectetur adipisicing elit. A asperiores, earum aperiam molestiae deserunt optio?
            </div> -->
            <p>
                        <label for="id_title">Title:</label>
                        <input type="text" name="title" maxlength="150" required="" id="id_title">
                        
                        
                    </p>

                    
                    <p>
                        <label for="id_description">Description:</label>
                        <textarea name="description" cols="40" rows="10" required="" id="id_description"></textarea>
                        
                        
                    </p>

                    
                    <p>
                        <label for="id_type">Type:</label>
                        <select name="type" required="" id="id_type">
                            <option value="" selected="">---------</option>

                            <option value="bug">bug</option>

                            <option value="feature">feature</option>

                            <option value="task">task</option>

                        </select>
                        
                        
                    </p>

                    <p>
                        <label for="id_progress">Progress:</label>
                        <input type="number" name="progress" step="0.01" required="" id="id_progress">
                        
                        
                      </p>
                    <p>
                        <label for="id_priority">Priority:</label>
                        <input type="number" name="priority" min="0" required="" id="id_priority">
                        
                        
                    </p>

                    
                    <p>
                        <label for="id_due_date">Due date:</label>
                        <input type="date" name="due_date" id="id_due_date">
                    </p>-up
            <button id="close_modal" type="submit" class="modal__close">Cerrar modal</button>
        </form>
    </section>
    <!-- fin Modal 2-->



    
    {% endblock content %}

    <h3><a href="{% url 'users_app:user_logout' %}">Log out</a></h3>
    <script src="{% static 'js/modal.js' %}"></script>
</body>
</html>